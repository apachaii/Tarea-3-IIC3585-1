<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <script type="text/javascript" src="main_algorithm.js"></script>
    <script type="text/javascript" src="javascript_algorithm.js"></script>
</head>
<body>
<button value="process1" onclick="c_algorithm_fast(1)">C  1</button>
<button value="process2" onclick="c_algorithm_fast(2)">C  2</button>
<button value="process3" onclick="c_algorithm_fast(3)">C  3</button>
<button value="process4" onclick="c_algorithm_fast(4)">C  4</button>
<button value="process5" onclick="c_algorithm_fast(5)">C  5</button>
<button value="process6" onclick="c_algorithm_fast(6)">C  6</button>
<button value="process7" onclick="c_algorithm_fast(7)">C  7</button>
<button value="process8" onclick="c_algorithm_fast(8)">C  8</button>
<button value="process9" onclick="c_algorithm_fast(9)">C  9</button>
<button value="process10" onclick="c_algorithm_fast(10)">C 10</button>
<br>
<button value="process1" onclick="javascript_algorithm_fast(1)">JS 1</button>
<button value="process2" onclick="javascript_algorithm_fast(2)">JS 2</button>
<button value="process3" onclick="javascript_algorithm_fast(3)">JS 3</button>
<button value="process4" onclick="javascript_algorithm_fast(4)">JS 4</button>
<button value="process5" onclick="javascript_algorithm_fast(5)">JS 5</button>
<button value="process6" onclick="javascript_algorithm_fast(6)">JS 6</button>
<button value="process7" onclick="javascript_algorithm_fast(7)">JS 7</button>
<button value="process8" onclick="javascript_algorithm_fast(8)">JS 8</button>
<button value="process9" onclick="javascript_algorithm_fast(9)">JS 9</button>
<button value="process10" onclick="javascript_algorithm_fast(10)">JS10</button>
<script>
    const find_best_algorithms = {}
    Module.onRuntimeInitialized = async _ => {
        find_best_algorithms.fast = Module.cwrap(
            'c_algorithm_fast', null, ['number', 'number']
        );
        find_best_algorithms.complete = Module.cwrap(
            'c_algorithm_complete', null, ['number', 'number']
        );
    };

    function execute_algorithm(find_best,set_length) {

        // Create example data to test float_multiply_array
        let data = new Uint32Array(set_length);

        // Get data byte size, allocate memory on Emscripten heap, and get pointer
        let nDataBytes = data.length * data.BYTES_PER_ELEMENT;
        //Module.TOTAL_MEMORY = nDataBytes; // added by jo
        let dataPtr = Module._malloc(nDataBytes);

        // Copy data to Emscripten heap (directly accessed from Module.HEAPU8)
        let dataHeap = new Uint8Array(Module.HEAPU8.buffer, dataPtr, nDataBytes);
        dataHeap.set(new Uint8Array(data.buffer));

        // Call function and get result
        find_best(dataHeap.byteOffset, set_length);
        let best_found = new Uint32Array(dataHeap.buffer, dataHeap.byteOffset, data.length);

        // Free memory
        Module._free(dataHeap.byteOffset);

        console.log("C",best_found);
        return best_found;
    }

    function c_algorithm_fast(set_length) {
        return execute_algorithm(find_best_algorithms.fast,set_length)
    }

    function c_algorithm_complete(set_length) {
        return execute_algorithm(find_best_algorithms.complete,set_length)
    }
</script>

</body>
</html>